---
title: "A Couple of UI Patterns with React and Framer Motion"
date: 2020-06-02
author: Thomas O'Neill
---

A website's navigation interface is a fundamental part of the user experience.
As a web developer or designer, you'll be creating headers, footers, sidebars
etc. for most projects. You want to spend more time creating a unique site for
your client, and less time re-implementing the same feature.

Let's get straight into a code example to get a sense of what we're dealing
with. Here's a similar header to the one we use for [the bearjam.dev site](/):

<!-- <iframe src="https://codesandbox.io/embed/github/mysterybear/blog-post-demos/tree/master/packages/header-3" /> -->

Now let's break down what it does:

- It's **responsive**: the header adapts to changes in screen size (specifically
  at 640px width breakpoint, try dragging the view narrower).
- When the screen width is below the breakpoint, **there is a toggle menu to
  expand/collapse the mobile header**.
- When the screen width is 640px or greater, the navigation links are displayed
  horizontally on the desktop header.
- When the mobile header is expanded, there's a **staggered animation** to bring
  the links into view (and this effect is reversed upon collapse).
- **The active link indication is different between mobile and desktop**: on
  mobile, the active link text colour is blue; on desktop, the active link has a
  blue underline.
- When clicking the desktop header links, **the blue underline transitions
  between links**.

At first glance it may appear that the main problem here is to write all of
these animations, but luckily there's
[Framer Motion](https://www.framer.com/api/motion/)[^1], which makes declaring
each of these animations almost boringly simple!

The real problem, we found, was to keep our code clean and readble, to abide by
the DRY principle, as we worked through these requirements.

We identified two key patterns that really helped with this, so here they are.

Furthermore, we use Next.js in the example code here. For bearjam.dev we use
Gatsby. These are on top of React, so of course we are using React. But in a
sense the two patterns that allow us to bring all this together so nicely are
kind of agnostic!

## Pattern #1: The "Root > Backdrop + Container"

```jsx
<Root>
  <Backdrop />
  <Container>{children}</Container>
</Root>
```

Maybe show the side agnostic example plus media queries for double header here.

## Pattern #2: Function as Child Component Nav

```jsx
const NavLink = ({ children, href, label, i, ...props }) => {
  const { pathname } = useRouter()
  const pathBeginning = `/${pathname.split("/")[1]}`
  const active = pathBeginning === href
  return children ? (
    children({ href, label, active, ...props }, i)
  ) : (
    <Link key={href} href={href} {...props}>
      <a>{label}</a>
    </Link>
  )
}
export const Nav = ({ children, ...props }) => {
  return (
    <motion.nav {...props}>
      {links.map((linkProps, i) => (There's also
[React Spring](http://react-spring.io/) but we'll use the former in our code
here.
        <NavLink
          key={linkProps.href}
          children={children}
          {...linkProps}
          i={i}
        />
      ))}
    </motion.nav>
  )
}
```

is consumed as ... mobile:

```jsx
<AnimatePresence>
  {open && (
    <Nav
      className={styles.navMobile}
      variants={{
        open: {
          transition: {
            staggerChildren: 0.3,
            delayChildren: 0.3,
          },
        },
        closed: {
          transition: {
            staggerChildren: 0.3,
            staggerDirection: -1,
          },
        },
      }}
      initial="closed"
      animate="open"
      exit="closed"
    >
      {({ href, label, active }) => (
        <motion.div
          initial="closed"
          variants={{
            open: {
              opacity: 1,
            },
            closed: {
              opacity: 0,
            },
          }}
          onClick={() => void setOpen(false)}
        >
          <Link href={href}>
            <a data-active={active}>{label}</a>
          </Link>
        </motion.div>
      )}
    </Nav>
  )}
</AnimatePresence>
```

... desktop ...

```jsx
<AnimateSharedLayout>
  <Nav className={styles.navDesktop}>
    {({ href, label, active }) => (
      <Link href={href}>
        <a>
          <span>{label}</span>
          {active && <motion.div layoutId="underline" />}
        </a>
      </Link>
    )}
  </Nav>
</AnimateSharedLayout>
```

<!-- What we came up with turned out to be reusable sidebars, footers, modals and so on. -->

### Footnotes

[^1]:
  There's also [React Spring](http://react-spring.io/) but we'll use the former
  in our code here.
